jQuery(function(a){var h={supports_html5_storage:!0,set_cart_creation_timestamp:function(){this.supports_html5_storage&&sessionStorage.setItem("wc_cart_created",(new Date).getTime())},set_cart_hash:function(a){this.supports_html5_storage&&(localStorage.setItem(wc_cart_fragments_params.cart_hash_key,a),sessionStorage.setItem(wc_cart_fragments_params.cart_hash_key,a))},refresh_cart:function(){a.ajax({url:wc_price_based_country_frontend_params.wc_ajax_url.toString().replace("%%endpoint%%","get_refreshed_fragments"),
type:"POST",success:function(b){b&&b.fragments&&(a.each(b.fragments,function(b,d){a(b).replaceWith(d)}),h.supports_html5_storage&&(sessionStorage.setItem(wc_cart_fragments_params.fragment_name,JSON.stringify(b.fragments)),h.set_cart_hash(b.cart_hash),b.cart_hash&&h.set_cart_creation_timestamp()))}})},set_refresh_cart_flag:function(){"undefined"===typeof Cookies?a.cookie("wc_pbc_refresh_cart","1"):Cookies.set("wc_pbc_refresh_cart","1")},get_refresh_cart_flag:function(){return"undefined"===typeof Cookies?
a.cookie("wc_pbc_refresh_cart"):Cookies.get("wc_pbc_refresh_cart")},remove_refresh_cart_flag:function(){"undefined"===typeof Cookies?a.removeCookie("wc_pbc_refresh_cart"):Cookies.remove("wc_pbc_refresh_cart")},maybe_refresh_cart:function(){"undefined"!==typeof this.get_refresh_cart_flag()&&(this.remove_refresh_cart_flag(),this.refresh_cart())},init:function(){if("undefined"===typeof wc_cart_fragments_params)return!1;try{this.supports_html5_storage="sessionStorage"in window&&null!==window.sessionStorage,
window.sessionStorage.setItem("wcpbc","test"),window.sessionStorage.removeItem("wcpbc"),window.localStorage.setItem("wcpbc","test"),window.localStorage.removeItem("wcpbc")}catch(b){this.supports_html5_storage=!1}this.maybe_refresh_cart();a("form[class ^= wcpbc-widget]").on("submit",function(b){0<a("form.woocommerce-checkout").length||h.set_refresh_cart_flag()});a(document.body).on("updated_checkout",function(a,g){h.refresh_cart()})}};h.init();var f={xhr:!1,get_product_ids:function(){var b=[];a("span.wcpbc-price").each(function(g,
d){var c=a(d).data("product-id");if("undefined"==typeof c){var e=a(d).attr("class").match(/wcpbc-price-\d+/);0<e.length&&(c=e[0].replace("wcpbc-price-",""))}b.push(c)});a.each(a("form.variations_form").data("product_variations"),function(a,d){"undefined"!==typeof d.variation_id&&b.push(d.variation_id)});a(document.body).trigger("wc_price_based_country_get_product_ids",[b]);return b},get_areas:function(){var b={};a(".wc-price-based-country-refresh-area").each(function(g,d){var c=a(d).data("area"),
e=a(d).data("id"),f=a(d).data("options");"undefined"!==typeof c&&"undefined"!==typeof e&&"undefined"!==typeof f&&("undefined"==typeof b[c]&&(b[c]={}),b[c][e]=f)});return b},refresh_product_price:function(b){a.each(b,function(b,c){a(".wcpbc-price.wcpbc-price-"+c.id).html(a(c.price_html).html()).css("visibility","");a(".wcpbc-price.wcpbc-price-"+c.id).html(a(c.price_html).html()).removeClass("loading")});var g=a("form.variations_form").data("product_variations");"undefined"!==typeof g&&(a.each(g,function(d,
c){var e=a(c.price_html);"undefined"!==typeof b[c.variation_id]&&(g[d].display_price=b[c.variation_id].display_price,g[d].display_regular_price=b[c.variation_id].display_regular_price,e.hasClass("price")?e.first().html(b[c.variation_id].price_html):e.html(b[c.variation_id].price_html));e.find(".wcpbc-price").css("visibility","");e.find(".wcpbc-price").removeClass("loading");g[d].price_html=e.html()}),a("form.variations_form").data("product_variations",g));a(document.body).trigger("wc_price_based_country_set_product_price",
[b]);a(".wcpbc-price").css("visibility","");a(".wcpbc-price").removeClass("loading")},refresh_areas:function(b){a.each(b,function(b,d){console.log("area:"+b);var c='.wc-price-based-country-refresh-area[data-id="'+d.id+'"][data-area="'+d.area+'"]',e=a(d.content).filter('.wc-price-based-country-refresh-area[data-area="'+d.area+'"]').html();a(c).html(e)})},geolocate_customer:function(){f.xhr&&f.xhr.abort();var b={country:wc_price_based_country_frontend_params.country,ids:f.get_product_ids(),areas:f.get_areas()};
f.xhr=a.ajax({url:wc_price_based_country_frontend_params.wc_ajax_url.toString().replace("%%endpoint%%","wcpbc_get_location"),data:b,type:"GET",success:function(a){f.refresh_product_price(a.products);f.refresh_areas(a.areas)}})},init:function(){"1"===wc_price_based_country_frontend_params.ajax_geolocation&&this.geolocate_customer()}};f.init()});